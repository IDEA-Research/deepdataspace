"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[721],{54104:function(te,w,o){var k=o(57370),U=o(47075),Q=o(58757),z=o(17148),G=o(35667),y=["fieldProps","proFieldProps"],Y=["fieldProps","proFieldProps"],g="text",D=function(h){var c=h.fieldProps,L=h.proFieldProps,Z=(0,U.Z)(h,y);return(0,G.jsx)(z.Z,(0,k.Z)({valueType:g,fieldProps:c,filedConfig:{valueType:g},proFieldProps:L},Z))},R=function(h){var c=h.fieldProps,L=h.proFieldProps,Z=(0,U.Z)(h,Y);return(0,G.jsx)(z.Z,(0,k.Z)({valueType:"password",fieldProps:c,proFieldProps:L,filedConfig:{valueType:g}},Z))},W=D;W.Password=R,W.displayName="ProFormComponent",w.Z=W},19612:function(te,w,o){o.d(w,{Z:function(){return y}});var k=o(81029),U=o(32814),Q={tagsWrap:"tagsWrap___bmrPM"},z=o(35667),G=function(g){var D=g.data,R=g.max,W=g.isPerson,S=R?D.slice(0,R):D;return(0,z.jsxs)("div",{className:Q.tagsWrap,children:[S&&S.map(function(h){return(0,z.jsx)(U.Z,{icon:W?(0,z.jsx)(k.Z,{}):null,color:h.color||"geekblue",children:h.text},h.text)}),S.length<D.length?"...":""]})},y=G},66580:function(te,w,o){o.r(w),o.d(w,{default:function(){return $e}});var k=o(61845),U=o(24977),Q=o(30956),z=o(32814),G=o(12562),y=o(97375),Y=o(24454),g=o.n(Y),D=o(56592),R=o.n(D),W=o(91290),S=o(95122),h=o(54104),c=o(57370),L=o(47075),Z=o(58757),J=o(17148),e=o(35667),ce=["fieldProps","proFieldProps"],ve=function(s,d){var l=s.fieldProps,n=s.proFieldProps,f=(0,L.Z)(s,ce);return(0,e.jsx)(J.Z,(0,c.Z)({ref:d,valueType:"textarea",fieldProps:l,proFieldProps:n},f))},ae=Z.forwardRef(ve),le=o(92588),ee=o(64410),me=o(38904),se=o(7798),je=["options","fieldProps","proFieldProps","valueEnum"],Pe=Z.forwardRef(function(i,s){var d=i.options,l=i.fieldProps,n=i.proFieldProps,f=i.valueEnum,x=(0,L.Z)(i,je);return(0,e.jsx)(J.Z,(0,c.Z)({ref:s,valueType:"checkbox",valueEnum:(0,ee.h)(f,void 0),fieldProps:(0,c.Z)({options:d},l),lightProps:(0,c.Z)({labelFormatter:function(){return(0,e.jsx)(J.Z,(0,c.Z)({ref:s,valueType:"checkbox",mode:"read",valueEnum:(0,ee.h)(f,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,c.Z)({options:d},l),proFieldProps:n},x))}},x.lightProps),proFieldProps:n},x))}),he=Z.forwardRef(function(i,s){var d=i.fieldProps,l=i.children;return(0,e.jsx)(me.Z,(0,c.Z)((0,c.Z)({ref:s},d),{},{children:l}))}),fe=(0,se.G)(he,{valuePropName:"checked"}),ne=fe;ne.Group=Pe;var xe=ne,ie=o(19943),de=o(10852),ge=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],Fe=Z.forwardRef(function(i,s){var d=i.fieldProps,l=i.options,n=i.radioType,f=i.layout,x=i.proFieldProps,E=i.valueEnum,A=(0,L.Z)(i,ge);return(0,e.jsx)(J.Z,(0,c.Z)((0,c.Z)({valueType:n==="button"?"radioButton":"radio",ref:s,valueEnum:(0,ee.h)(E,void 0)},A),{},{fieldProps:(0,c.Z)({options:l,layout:f},d),proFieldProps:x,filedConfig:{customLightMode:!0}}))}),be=Z.forwardRef(function(i,s){var d=i.fieldProps,l=i.children;return(0,e.jsx)(de.ZP,(0,c.Z)((0,c.Z)({},d),{},{ref:s,children:l}))}),Me=(0,se.G)(be,{valuePropName:"checked",ignoreWidth:!0}),X=Me;X.Group=Fe,X.Button=de.ZP.Button,X.displayName="ProFormComponent";var pe=X,Te=["fieldProps","min","proFieldProps","max"],ye=function(s,d){var l=s.fieldProps,n=s.min,f=s.proFieldProps,x=s.max,E=(0,L.Z)(s,Te);return(0,e.jsx)(J.Z,(0,c.Z)({valueType:"digit",fieldProps:(0,c.Z)({min:n,max:x},l),ref:d,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:f},E))},Ze=Z.forwardRef(ye),Ce=Ze,Ee=o(62109),Se=o(15618),oe=o(53357),Ie=o(54518),M=o(35459),V=o(1239),Ne=function(){var s=(0,y.useModel)("user"),d=s.user,l=(0,y.useModel)("Project.list"),n=l.projectModal,f=l.closeProjectModal,x=l.onProjectModalCurrentChange,E=l.projectModalNext,A=l.projectModalFinish,I=(0,y.useModel)("Project.auth"),H=I.checkPermission,O=(0,oe.bU)(),r=O.localeText,$=(0,Z.useRef)([]),t=n.targetProject,_=t&&t.status!==M.tz.Waiting,K=!!t,N=t&&!H(t.userRoles,V.Oc.ProjectEdit),p=_||n.disableInitProject,a=function(v){if(!t||!_){var m,j,F,P=(m=$.current)===null||m===void 0?void 0:m[0],B=(j=$.current)===null||j===void 0?void 0:j[1],T=P==null||(F=P.current)===null||F===void 0?void 0:F.getFieldValue(["basics","managerIds"]),b=T==null?void 0:T.includes(d.userId);if(!b){var C;B==null||(C=B.current)===null||C===void 0||C.setFieldValue(["workflowInitNow"],[])}}return E(v)};return(0,e.jsx)(Ee.Z,{title:r(t?"proj.editModal.editProj":"proj.editModal.newProj"),width:750,open:n.show,onCancel:f,destroyOnClose:!0,footer:null,maskClosable:!1,children:(0,e.jsxs)(S.L0,{formMapRef:$,current:n.current,onCurrentChange:x,onFinish:A,formProps:{initialValues:n.initialValues},children:[(0,e.jsxs)(S.L0.StepForm,{name:"basics",title:r("proj.editModal.stepForm.title"),stepProps:{description:r("proj.editModal.stepForm.desc")},onFinish:a,disabled:N,children:[(0,e.jsx)(h.Z,{label:r("proj.editModal.stepForm.name.label"),placeholder:r("proj.editModal.stepForm.name.placeholder"),name:["basics","name"],rules:[{required:!0,message:r("proj.editModal.stepForm.name.rule")}],disabled:K}),(0,e.jsx)(ae,{label:r("proj.editModal.stepForm.desc.label"),placeholder:r("proj.editModal.stepForm.desc.placeholder"),name:["basics","description"]}),(0,e.jsx)(le.Z.SearchSelect,{label:r("proj.editModal.stepForm.dataset.label"),placeholder:r("proj.editModal.stepForm.dataset.placeholder"),name:["basics","datasetIds"],fieldProps:{mode:"multiple",labelInValue:!1},debounceTime:300,request:function(){var u=R()(g()().mark(function v(m){var j,F,P,B;return g()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return j=m.keyWords,F=j===void 0?"":j,P=(t==null?void 0:t.datasets)||[],b.next=4,(0,W.J9)({name:F,purpose:"label_project"});case 4:return B=b.sent.datasetList.map(function(C){return{label:C.name,value:C.id,disabled:!C.valid}}),P.forEach(function(C){B.find(function(Ke){return Ke.value===C.id})||B.push({label:C.name,value:C.id,disabled:!1})}),b.abrupt("return",B);case 7:case"end":return b.stop()}},v)}));return function(v){return u.apply(this,arguments)}}(),rules:[{required:!0,message:r("proj.editModal.stepForm.dataset.rule"),type:"array"}],disabled:K}),(0,e.jsx)(h.Z,{label:r("proj.editModal.stepForm.preLabel.label"),placeholder:r("proj.editModal.stepForm.preLabel.placeholder"),name:["basics","preLabel"],disabled:K}),(0,e.jsx)(ae,{label:r("proj.editModal.stepForm.category.label"),placeholder:r("proj.editModal.stepForm.category.placeholder"),name:["basics","categories"],rules:[{required:!0,message:r("proj.editModal.stepForm.category.rule")}],disabled:K}),(0,e.jsx)(le.Z.SearchSelect,{label:r("proj.editModal.stepForm.PM.label"),placeholder:r("proj.editModal.stepForm.PM.placeholder"),extra:r("proj.editModal.stepForm.PM.extra"),name:["basics","managerIds"],fieldProps:{mode:"multiple",labelInValue:!1},debounceTime:300,request:function(){var u=R()(g()().mark(function v(m){var j,F,P;return g()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(j=m.keyWords,F=j===void 0?"":j,P=(t==null?void 0:t.managers)||[],!F){T.next=6;break}return T.next=5,(0,W.Qm)({email:F});case 5:P=T.sent.userList.map(function(b){return{name:b.email,id:b.id}});case 6:return T.abrupt("return",P.map(function(b){return{label:b.name,value:b.id}}));case 7:case"end":return T.stop()}},v)}));return function(v){return u.apply(this,arguments)}}(),rules:[{required:!0,message:r("proj.editModal.stepForm.PM.rule"),type:"array"}]})]}),(0,e.jsxs)(S.L0.StepForm,{name:"taskSetting",title:r("proj.editModal.stepForm.task.title"),stepProps:{description:r("proj.editModal.stepForm.task.desc")},disabled:p,children:[n.disableInitProject&&(0,e.jsx)(Se.Z,{style:{marginBottom:20},message:r("proj.editModal.stepForm.task.msg"),type:"warning"}),(0,e.jsx)(xe.Group,{name:"workflowInitNow",options:[r(Ie.I)]}),(0,e.jsx)(ie.Z,{name:["workflowInitNow"],children:function(v){var m=v.workflowInitNow;return m&&m.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(pe.Group,{name:"hadBatchSize",label:r("proj.editModal.stepForm.radio.label"),options:[{label:r("proj.editModal.stepForm.radio.dataset"),value:!1},{label:r("proj.editModal.stepForm.radio.size"),value:!0}]}),(0,e.jsx)(ie.Z,{name:["hadBatchSize"],children:function(F){var P=F.hadBatchSize;return P?(0,e.jsx)(Ce,{label:r("proj.editModal.stepForm.batchSize.label"),name:["settings","batchSize"],min:1,width:"sm",placeholder:r("proj.editModal.stepForm.batchSize.placeholder"),tooltip:r("proj.editModal.stepForm.batchSize.tooltip"),rules:[{required:!0,message:r("proj.editModal.stepForm.batchSize.msg")}]}):null}}),(0,e.jsx)(pe.Group,{name:"hadReviewer",label:r("proj.editModal.stepForm.rview.label"),options:[{label:r("proj.editModal.stepForm.rview.no"),value:!1},{label:r("proj.editModal.stepForm.rview.one"),value:!0}]})]}):(0,e.jsx)("div",{style:{width:"100%",height:"200px"}})}})]})]})})},Be=Ne,ze=o(95664),Re=function(s){var d=s.complete,l=s.total;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ze.Z,{percent:d/l*100,showInfo:!1,trailColor:"#e4e4e4"}),(0,e.jsx)("div",{children:"".concat(d," / ").concat(l)})]})},We=Re,Le=o(9457),q=o(19612),Oe=o(95073),re={page:"page___VUB1h",table:"table___BzPd6",actionCell:"actionCell___IDtFO"},De=o(88205),Ae=o.n(De),we=o(47867),ke=o(47513),ue={link:"link___BBH6k",input:"input___Wk1gH"},Ue=function(s){var d=s.projectId,l=(0,y.useModel)("Project.list"),n=l.onExportLabelProject,f=ke.Z.useForm(),x=Ae()(f,1),E=x[0],A=(0,oe.bU)(),I=A.localeText;return(0,e.jsx)(we.Y,{title:I("proj.exportModal.title"),width:450,trigger:(0,e.jsx)("span",{className:ue.link,children:I("proj.table.action.export")}),form:E,autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0},submitTimeout:2e3,onFinish:function(){var H=R()(g()().mark(function O(r){return g()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(d,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},O)}));return function(O){return H.apply(this,arguments)}}(),className:ue.input,children:(0,e.jsx)(h.Z,{label:I("proj.exportModal.labelName.name"),name:"labelName",rules:[{required:!0,message:I("proj.exportModal.labelName.rule")}],extra:I("proj.exportModal.labelName.tips")})})},Ge=Ue,Ve=function(){var s=(0,y.useModel)("Project.auth"),d=s.checkPermission,l=(0,Oe.Z)(document.querySelector(".ant-pro-grid-content")),n=(0,y.useModel)("Project.list"),f=n.pageData,x=n.pageState,E=n.loading,A=n.onPageChange,I=n.onInitPageState,H=n.onNewProject,O=n.onEditProject,r=n.onChangeProjectResult;(0,Le._)({onInitPageState:I,pageState:x});var $=(0,oe.bU)(),t=$.localeText,_=function(p){var a=[];return d(p.userRoles,V.Oc.ProjectQa)&&[M.tz.Reviewing].includes(p.status)&&(a.push((0,e.jsx)("a",{style:{color:"#4fbb30"},onClick:function(){return r(p,M.JE.Accept)},children:t("proj.table.action.accept")},"accept")),a.push((0,e.jsx)(Q.Z,{title:t("proj.table.action.reject.tips"),onConfirm:function(){return r(p,M.JE.Reject)},children:(0,e.jsx)("a",{style:{color:"red"},children:t("proj.table.action.reject")},"reject")},"reject"))),d(p.userRoles,V.Oc.ProjectEdit)?a.push((0,e.jsx)("a",{onClick:function(){O(p)},children:t("proj.table.action.edit")},"edit")):d(p.userRoles,V.Oc.ProjectInit)&&p.status===M.tz.Waiting?a.push((0,e.jsx)("a",{onClick:function(){O(p)},children:t("proj.table.action.init")},"init")):d(p.userRoles,V.Oc.ProjectInfo)&&p.status!==M.tz.Waiting&&a.push((0,e.jsx)("a",{onClick:function(){O(p)},children:t("proj.table.action.info")},"info")),[M.tz.Waiting,M.tz.Initializing].includes(p.status)||a.push((0,e.jsx)(y.Link,{to:"/project/".concat(p.id),children:t("proj.table.action.detail")},"detail")),d(p.userRoles,V.Oc.ProjectExport)&&p.status===M.tz.Accepted&&a.push((0,e.jsx)("a",{children:(0,e.jsx)(Ge,{projectId:p.id})},"export")),a},K=[{title:t("proj.table.name"),dataIndex:"name",ellipsis:!1},{title:t("proj.table.owner"),ellipsis:!0,render:function(p,a){return(0,e.jsx)(q.Z,{isPerson:!0,data:[{text:a.owner.name,color:"green"}]})}},{title:t("proj.table.datasets"),ellipsis:!0,render:function(p,a){var u,v,m,j,F=JSON.stringify({datasetId:a==null||(u=a.datasets)===null||u===void 0||(v=u[0])===null||v===void 0?void 0:v.id,datasetName:a==null||(m=a.datasets)===null||m===void 0||(j=m[0])===null||j===void 0?void 0:j.name});return a.status===M.tz.Exported?(0,e.jsx)("a",{href:"".concat(window.location.origin,"/page/dataset/detail?pageState=").concat(encodeURIComponent(F)),target:"blank",children:(0,e.jsx)(q.Z,{max:2,data:a.datasets.map(function(P){return{text:P.name,color:"blue"}})})}):(0,e.jsx)(q.Z,{max:2,data:a.datasets.map(function(P){return{text:P.name,color:"blue"}})})}},{title:t("proj.table.progress"),render:function(p,a){return a.taskNumTotal?(0,e.jsx)(We,{complete:a.taskNumAccepted,total:a.taskNumTotal}):"-"}},{title:t("proj.table.PM"),ellipsis:!0,render:function(p,a){var u;return(0,e.jsx)(q.Z,{isPerson:!0,max:2,data:(u=a.managers)===null||u===void 0?void 0:u.map(function(v){return{text:v.name}})})}},{title:t("proj.table.status"),dataIndex:"status",ellipsis:!0,valueType:"select",valueEnum:M.mu,render:function(p,a){var u=M.mu[a.status],v=u.text,m=u.color;return(0,e.jsx)(z.Z,{color:m,children:t(v)})}},{title:t("proj.table.createAt"),dataIndex:"createdTs",valueType:"date"},{title:t("proj.table.action"),valueType:"option",key:"option",render:function(p,a){return(0,e.jsx)("div",{className:re.actionCell,children:_(a)})}}];return(0,e.jsxs)(k._z,{className:re.page,header:{title:t("proj.title"),extra:[(0,e.jsxs)(G.ZP,{type:"primary",onClick:H,children:["+ ",t("proj.table.newProject")]},"new")],breadcrumb:{}},children:[(0,e.jsx)(U.Z,{rowKey:"id",className:re.table,scroll:{x:1200,y:l!=null&&l.height?l.height-124:void 0},columns:K,cardBordered:!0,dataSource:f.list,toolBarRender:function(){return[(0,e.jsx)(e.Fragment,{})]},options:!1,search:!1,loading:E,pagination:{current:x.page,pageSize:x.pageSize,total:f.total,showSizeChanger:!0,onChange:A}}),(0,e.jsx)(Be,{})]})},$e=Ve}}]);
