"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[914],{87615:function(oe,S,e){e.d(S,{Z:function(){return T}});var p=e(58757),R=e(38904),y=e(10852),M=e(73267),d=e(57414),b=e(12562),L=e(10130),O=e(53357),j={dropdownSelector:"dropdownSelector___gvMFq",dropdownWrap:"dropdownWrap___WWYlz",dropdownBox:"dropdownBox___lpUVf"},o=e(35667),D=function(i){var s=i.data,w=i.multiple,N=i.type,m=N===void 0?"primary":N,C=i.ghost,V=C===void 0?!0:C,$=i.value,t=i.filterOptionValue,k=i.filterOptionName,f=i.onChange,Y=i.className,x=i.children,P=i.customOverlay,u=w?R.Z:y.ZP,a=function(n){f&&f(w?n:n.target.value)};return(0,o.jsx)(M.Z,{overlayClassName:j.dropdownSelector,trigger:["click"],dropdownRender:function(){return(0,o.jsx)("div",{className:j.dropdownWrap,children:P||(0,o.jsx)(u.Group,{className:j.dropdownBox,onChange:a,value:$,children:(0,o.jsx)(d.Z,{direction:"vertical",children:s==null?void 0:s.map(function(n,B){var H=t?t(n):n,z=k?k(n):n;return(0,o.jsx)(u,{value:H,children:(0,O._w)(z)},B)})})})})},children:(0,o.jsxs)(b.ZP,{className:Y,type:m,ghost:V,children:[x,(0,o.jsx)(L.Z,{})]})})},T=D},61470:function(oe,S,e){e.r(S),e.d(S,{default:function(){return f}});var p=e(58757),R=e(97375),y=e(9457),M=e(61845),d=e(12562),b=e(16951),L=e(37617),O=e(79233),j=e(18695),o={page:"page___DZyiW",header:"header___bRKb4",backBtn:"backBtn___yET2T",tabs:"tabs___weXzX",btn:"btn____fESN",line:"line___k1GQQ",item:"item___Jv55m",itemImgWrap:"itemImgWrap___bWdL3",flagIcon:"flagIcon___PULYz",label:"label___LGG_W",itemSelectedMask:"itemSelectedMask___mU2PX",topSpin:"topSpin___eLVKZ",bottomSpin:"bottomSpin___MuKRE",pagination:"pagination___WlY5J",pageSpin:"pageSpin___BAc4e",editor:"editor___YUj9q"},D=e(39378),T=e(87615),G=e(93059),i=e(14122),s=e(35459),w=e(92183),N=e(22283),m=e(1239),C=e(95073),V=e(23707),$=e(53357),t=e(35667),k=function(){var x,P=(0,R.useModel)("Project.auth"),u=P.checkPermission,a=(0,R.useModel)("Project.workspace"),r=a.pageData,n=a.pageState,B=a.loading,H=a.loadPageData,z=a.onInitPageState,ne=a.projectId,l=a.curRole,h=a.userRoles,re=a.tabItems,A=a.labelImages,F=a.isEditorVisible,ie=a.onStatusTabChange,le=a.onRoleChange,se=a.clickItem,de=a.loadMore,ce=a.onExitEditor,ue=a.onNextImage,ve=a.onPrevImage,ge=a.onLabelSave,me=a.onReviewResult,X=a.onEnterEdit,J=a.onStartLabel,Q=a.onStartRework,q=a.onStartReview;(0,y._)({onInitPageState:z,pageState:n});var he=(0,$.bU)(),v=he.localeText,pe=(0,y.w)(),je=pe.height,Z=(0,C.Z)(function(){return document.querySelector(".ant-pro-page-container")}),_=Z!=null&&Z.width?Z.width-80:0,fe=p.useRef(null),I=5,W=_?(_-16*(I-1))/(I||1):0,K=W*3/4,ee=je-46,xe=function(c){Math.floor(c.currentTarget.scrollHeight-c.currentTarget.scrollTop)===Math.floor(ee)&&de()},U=(0,p.useMemo)(function(){return(0,D.chunk)(A,I).map(function(E,c){return{index:c,lineImgs:E}})},[r.list]),Se=(0,p.useMemo)(function(){return r.editorMode!==i.je.View||n.taskStatus!==s.gZ.Working?[]:u(h,m.Oc.StartLabel)?n.status===s.j$.Labeling?[(0,t.jsx)(d.ZP,{type:"primary",onClick:J,children:v("proj.workspace.eTask.startLabel")},"label")]:n.status===s.j$.Reviewing?[(0,t.jsx)(d.ZP,{type:"primary",onClick:X,children:v("proj.workspace.eTask.edit")},"edit")]:n.status===s.j$.Rejected?[(0,t.jsx)(d.ZP,{type:"primary",onClick:Q,children:v("proj.workspace.eTask.startRework")},"rework")]:[]:u(h,m.Oc.StartReview)&&n.status===s.j$.Reviewing?[(0,t.jsx)(d.ZP,{type:"primary",onClick:q,children:v("proj.workspace.eTask.startReview")},"review")]:[]},[n.status,n.taskStatus,r.editorMode,h]);return(0,t.jsxs)(M._z,{ghost:!0,className:o.page,fixedHeader:!0,pageHeaderRender:function(){return(0,t.jsxs)("div",{className:o.header,children:[(0,t.jsx)(d.ZP,{icon:(0,t.jsx)(w.Z,{}),type:"text",className:o.backBtn,onClick:function(){return(0,V.yS)("/project/".concat(ne))}}),(0,t.jsx)(b.Z,{className:o.tabs,activeKey:n.status,onChange:ie,items:re,tabBarExtraContent:(0,t.jsxs)("div",{children:[(0,t.jsx)(d.ZP,{type:"text",className:o.btn,icon:(0,t.jsx)(N.Z,{}),onClick:function(){return H()}}),l&&(l==null?void 0:l.labelNumWaiting)>0&&n.taskStatus===s.gZ.Working&&u(h,m.Oc.StartLabel)&&(0,t.jsx)(d.ZP,{type:"primary",className:o.btn,onClick:J,children:v("proj.workspace.eProj.startLabeling")}),l&&(l==null?void 0:l.reviewNumRejected)>0&&n.taskStatus===s.gZ.Working&&u(h,m.Oc.StartLabel)&&(0,t.jsx)(d.ZP,{type:"primary",className:o.btn,onClick:Q,children:v("proj.workspace.eProj.startRework")}),l&&(l==null?void 0:l.reviewNumWaiting)>0&&n.taskStatus===s.gZ.Working&&u(h,m.Oc.StartReview)&&(0,t.jsx)(d.ZP,{type:"primary",className:o.btn,onClick:q,children:v("proj.workspace.eProj.startReview")}),(0,t.jsxs)(T.Z,{data:r.taskRoles,value:n.roleId||"",filterOptionName:function(g){return"".concat(g.userName," (").concat(g.role,")")},filterOptionValue:function(g){return g.id},onChange:le,ghost:!1,type:"default",children:[v("proj.workspace.eProj.role"),": ",l==null?void 0:l.userName,"(",l==null?void 0:l.role,")"]})]})})]})},children:[(0,t.jsx)(L.Z,{loading:B,className:o.list,children:U.length>0&&(0,t.jsx)(j.Z,{ref:fe,data:U,height:ee,itemHeight:K+16,itemKey:"index",onScroll:xe,children:function(c,g){return(0,t.jsxs)(p.Fragment,{children:[(0,t.jsx)("div",{className:o.line,children:c.lineImgs.map(function(te,ae){return(0,t.jsx)("div",{className:o.item,style:{width:W},onClick:function(){return se(g*I+ae)},children:(0,t.jsx)("div",{className:o.itemImgWrap,style:{width:W,height:K},children:(0,t.jsx)(i.D5,{categories:r.categoryList,data:te,wrapWidth:W,wrapHeight:K})})},"".concat(te.id,"_").concat(ae))})}),g===U.length-1&&r.loadingImagesType===G.D.More&&(0,t.jsx)(O.Z,{className:o.bottomSpin})]},g)}})}),F&&(0,t.jsx)("div",{className:o.editor,children:(0,t.jsx)(i.kl,{isSeperate:!1,mode:r.editorMode,visible:F,categories:r.categoryList,list:A,current:r.curIndex,pagination:{show:r.editorMode!==i.je.Review&&!(r.editorMode===i.je.Edit&&n.status===s.j$.Reviewing),total:r.total,customText:r.editorMode===i.je.Edit?(0,t.jsx)(t.Fragment,{}):void 0,customDisableNext:r.editorMode===i.je.Edit?!((x=r.list[r.curIndex])!==null&&x!==void 0&&x.labeled)||r.curIndex>=r.total-1:void 0},actionElements:Se,onCancel:ce,onSave:ge,onReviewResult:me,onEnterEdit:X,onNext:ue,onPrev:ve})})]})},f=k}}]);
