"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[914],{51885:function(K,S,e){e.d(S,{Z:function(){return M}});var c=e(8671),m=e(52983),E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},C=E,i=e(31680),x=function(g,s){return m.createElement(i.Z,(0,c.Z)((0,c.Z)({},g),{},{ref:s,icon:C}))};x.displayName="ReloadOutlined";var M=m.forwardRef(x)},4689:function(K,S,e){e.d(S,{Z:function(){return I}});var c=e(52983),m=e(44580),E=e(56084),C=e(57006),i=e(81553),x=e(58174),M=e(68505),p=e(26237),g={dropdownSelector:"dropdownSelector___gvMFq",dropdownWrap:"dropdownWrap___WWYlz",dropdownBox:"dropdownBox___lpUVf"},s=e(97458),O=function(l){var u=l.data,Z=l.multiple,w=l.type,W=w===void 0?"primary":w,f=l.ghost,N=f===void 0?!0:f,V=l.value,T=l.filterOptionValue,P=l.filterOptionName,D=l.onChange,$=l.className,_=l.children,t=l.customOverlay,U=Z?m.Z:E.ZP,J=function(d){D&&D(Z?d:d.target.value)};return(0,s.jsx)(C.Z,{overlayClassName:g.dropdownSelector,trigger:["click"],dropdownRender:function(){return(0,s.jsx)("div",{className:g.dropdownWrap,children:t||(0,s.jsx)(U.Group,{className:g.dropdownBox,onChange:J,value:V,children:(0,s.jsx)(i.Z,{direction:"vertical",children:u==null?void 0:u.map(function(d,L){var j=T?T(d):d,a=P?P(d):d;return(0,s.jsx)(U,{value:j,children:(0,p._w)(a)},L)})})})})},children:(0,s.jsxs)(x.ZP,{className:$,type:W,ghost:N,children:[_,(0,s.jsx)(M.Z,{})]})})},I=O},17445:function(K,S,e){e.d(S,{Z:function(){return M}});var c=e(63900),m=e.n(c),E=e(88205),C=e.n(E),i=e(52983),x=e(85661);function M(p){var g=p.pageState,s=p.onInitPageState,O=p.onPageDidMount,I=p.onPageWillUnmount,r=(0,x.Z)({},{navigateMode:"replace"}),l=C()(r,2),u=l[0],Z=l[1];(0,i.useEffect)(function(){if(s){var w={};try{w=u.pageState?JSON.parse(u.pageState):{}}catch(W){console.error("get urlPageState error: ",W)}s(w,u)}return O&&O(u),function(){I&&I()}},[]),(0,i.useEffect)(function(){Z(m()(m()({},u),{},{pageState:JSON.stringify(g)}))},[g])}},87986:function(K,S,e){e.r(S),e.d(S,{default:function(){return J}});var c=e(52983),m=e(48815),E=e(17445),C=e(18288),i=e(58174),x=e(5670),M=e(17212),p=e(19419),g=e(86451),s=e(88205),O=e.n(s);function I(){var A=(0,c.useState)(window.innerWidth),d=O()(A,2),L=d[0],j=d[1],a=(0,c.useState)(window.innerHeight),n=O()(a,2),v=n[0],Y=n[1],B=function(){j(window.innerWidth),Y(window.innerHeight)};return(0,c.useEffect)(function(){return window.addEventListener("resize",B),function(){window.removeEventListener("resize",B)}},[]),{width:L,height:v}}var r={page:"page___DZyiW",header:"header___bRKb4",backBtn:"backBtn___yET2T",tabs:"tabs___weXzX",btn:"btn____fESN",line:"line___k1GQQ",item:"item___Jv55m",itemImgWrap:"itemImgWrap___bWdL3",flagIcon:"flagIcon___PULYz",label:"label___LGG_W",itemSelectedMask:"itemSelectedMask___mU2PX",topSpin:"topSpin___eLVKZ",bottomSpin:"bottomSpin___MuKRE",pagination:"pagination___WlY5J",pageSpin:"pageSpin___BAc4e",editor:"editor___YUj9q"},l=e(22168),u=e(39378),Z=e(4689),w=e(80455),W=e(50454),f=e(4394),N=e(29880),V=e(89398),T=e(51885),P=e(73205),D=e(19950),$=e(32997),_=e(26237),t=e(97458),U=function(){var d,L=(0,m.useModel)("Project.auth"),j=L.checkPermission,a=(0,m.useModel)("Project.workspace"),n=a.pageData,v=a.pageState,Y=a.loading,B=a.loadPageData,q=a.onInitPageState,de=a.projectId,o=a.curRole,b=a.userRoles,ce=a.tabItems,ee=a.labelImages,ue=a.categoryColors,te=a.isEditorVisible,ve=a.onStatusTabChange,me=a.onRoleChange,ge=a.clickItem,he=a.loadMore,pe=a.onExitEditor,fe=a.onNextImage,je=a.onPrevImage,Se=a.onLabelSave,xe=a.onReviewResult,ae=a.onEnterEdit,ne=a.onStartLabel,oe=a.onStartRework,re=a.onStartReview;(0,E.Z)({onInitPageState:q,pageState:v});var Pe=(0,_.bU)(),R=Pe.localeText,Re=I(),ye=Re.height,k=(0,D.Z)(function(){return document.querySelector(".ant-pro-page-container")}),ie=k!=null&&k.width?k.width-80:0,Ee=c.useRef(null),G=5,z=ie?(ie-16*(G-1))/(G||1):0,F=z*3/4,le=ye-46,Ce=function(h){Math.floor(h.currentTarget.scrollHeight-h.currentTarget.scrollTop)===Math.floor(le)&&he()},Q=(0,c.useMemo)(function(){return(0,u.chunk)(ee,G).map(function(H,h){return{index:h,lineImgs:H}})},[n.list]),Me=(0,c.useMemo)(function(){return n.editorMode!==f.j.View?[]:j(b,P.Oc.StartLabel)?v.status===N.j$.Labeling?[(0,t.jsx)(i.ZP,{type:"primary",onClick:ne,children:R("proj.workspace.eTask.startLabel")},"label")]:v.status===N.j$.Reviewing?[(0,t.jsx)(i.ZP,{type:"primary",onClick:ae,children:R("proj.workspace.eTask.edit")},"edit")]:v.status===N.j$.Rejected?[(0,t.jsx)(i.ZP,{type:"primary",onClick:oe,children:R("proj.workspace.eTask.startRework")},"rework")]:[]:j(b,P.Oc.StartReview)&&v.status===N.j$.Reviewing?[(0,t.jsx)(i.ZP,{type:"primary",onClick:re,children:R("proj.workspace.eTask.startReview")},"review")]:[]},[v.status,n.editorMode,b]);return(0,t.jsxs)(C._z,{ghost:!0,className:r.page,fixedHeader:!0,pageHeaderRender:function(){return(0,t.jsxs)("div",{className:r.header,children:[(0,t.jsx)(i.ZP,{icon:(0,t.jsx)(V.Z,{}),type:"text",className:r.backBtn,onClick:function(){return(0,$.yS)("/project/".concat(de))}}),(0,t.jsx)(x.Z,{className:r.tabs,activeKey:v.status,onChange:ve,items:ce,tabBarExtraContent:(0,t.jsxs)("div",{children:[(0,t.jsx)(i.ZP,{type:"text",className:r.btn,icon:(0,t.jsx)(T.Z,{}),onClick:function(){return B()}}),o&&(o==null?void 0:o.labelNumWaiting)>0&&j(b,P.Oc.StartLabel)&&(0,t.jsx)(i.ZP,{type:"primary",className:r.btn,onClick:ne,children:R("proj.workspace.eProj.startLabeling")}),o&&(o==null?void 0:o.reviewNumRejected)>0&&j(b,P.Oc.StartLabel)&&(0,t.jsx)(i.ZP,{type:"primary",className:r.btn,onClick:oe,children:R("proj.workspace.eProj.startRework")}),o&&(o==null?void 0:o.reviewNumWaiting)>0&&j(b,P.Oc.StartReview)&&(0,t.jsx)(i.ZP,{type:"primary",className:r.btn,onClick:re,children:R("proj.workspace.eProj.startReview")}),(0,t.jsxs)(Z.Z,{data:n.taskRoles,value:v.roleId||"",filterOptionName:function(y){return"".concat(y.userName," (").concat(y.role,")")},filterOptionValue:function(y){return y.id},onChange:me,ghost:!1,type:"default",children:[R("proj.workspace.eProj.role"),": ",o==null?void 0:o.userName,"(",o==null?void 0:o.role,")"]})]})})]})},children:[(0,t.jsx)(M.ZP,{loading:Y,className:r.list,children:Q.length>0&&(0,t.jsx)(g.Z,{ref:Ee,data:Q,height:le,itemHeight:F+16,itemKey:"index",onScroll:Ce,children:function(h,y){return(0,t.jsxs)(c.Fragment,{children:[(0,t.jsx)("div",{className:r.line,children:h.lineImgs.map(function(X,se){return(0,t.jsx)("div",{className:r.item,style:{width:z},onClick:function(){return ge(y*G+se)},children:(0,t.jsx)("div",{className:r.itemImgWrap,style:{width:z,height:F},children:(0,t.jsx)(l.Z,{wrapWidth:z,wrapHeight:F,image:X,objects:X.objects,displayType:w.JJ.Detection,globalDisplayOptions:{categoryColors:ue}})})},"".concat(X.id,"_").concat(se))})}),y===Q.length-1&&n.loadingImagesType===W.D.More&&(0,t.jsx)(p.Z,{className:r.bottomSpin})]},y)}})}),te&&(0,t.jsx)("div",{className:r.editor,children:(0,t.jsx)(f.Z,{isSeperate:!1,mode:n.editorMode,visible:te,categories:n.categoryList,list:ee,current:n.curIndex,pagination:{show:n.editorMode!==f.j.Review&&!(n.editorMode===f.j.Edit&&v.status===N.j$.Reviewing),total:n.total,customText:n.editorMode===f.j.Edit?(0,t.jsx)(t.Fragment,{}):void 0,customDisableNext:n.editorMode===f.j.Edit?!((d=n.list[n.curIndex])!==null&&d!==void 0&&d.labeled)||n.curIndex>=n.total-1:void 0},actionElements:Me,onCancel:pe,onSave:Se,onReviewResult:xe,onEnterEdit:ae,onNext:fe,onPrev:je})})]})},J=U}}]);
