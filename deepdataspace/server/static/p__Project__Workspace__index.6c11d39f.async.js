"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[914],{87615:function(ae,S,e){e.d(S,{Z:function(){return T}});var h=e(58757),R=e(38904),w=e(10852),b=e(73267),d=e(57414),E=e(12562),O=e(10130),L=e(53357),j={dropdownSelector:"dropdownSelector___gvMFq",dropdownWrap:"dropdownWrap___WWYlz",dropdownBox:"dropdownBox___lpUVf"},o=e(35667),D=function(i){var s=i.data,y=i.multiple,N=i.type,m=N===void 0?"primary":N,C=i.ghost,V=C===void 0?!0:C,$=i.value,t=i.filterOptionValue,k=i.filterOptionName,f=i.onChange,G=i.className,x=i.children,P=i.customOverlay,u=y?R.Z:w.ZP,a=function(n){f&&f(y?n:n.target.value)};return(0,o.jsx)(b.Z,{overlayClassName:j.dropdownSelector,trigger:["click"],dropdownRender:function(){return(0,o.jsx)("div",{className:j.dropdownWrap,children:P||(0,o.jsx)(u.Group,{className:j.dropdownBox,onChange:a,value:$,children:(0,o.jsx)(d.Z,{direction:"vertical",children:s==null?void 0:s.map(function(n,B){var H=t?t(n):n,z=k?k(n):n;return(0,o.jsx)(u,{value:H,children:(0,L._w)(z)},B)})})})})},children:(0,o.jsxs)(E.ZP,{className:G,type:m,ghost:V,children:[x,(0,o.jsx)(O.Z,{})]})})},T=D},61470:function(ae,S,e){e.r(S),e.d(S,{default:function(){return f}});var h=e(58757),R=e(97375),w=e(28506),b=e(61845),d=e(12562),E=e(16951),O=e(37617),L=e(79233),j=e(18695),o={page:"page___DZyiW",header:"header___bRKb4",backBtn:"backBtn___yET2T",tabs:"tabs___weXzX",btn:"btn____fESN",line:"line___k1GQQ",item:"item___Jv55m",itemImgWrap:"itemImgWrap___bWdL3",flagIcon:"flagIcon___PULYz",label:"label___LGG_W",itemSelectedMask:"itemSelectedMask___mU2PX",topSpin:"topSpin___eLVKZ",bottomSpin:"bottomSpin___MuKRE",pagination:"pagination___WlY5J",pageSpin:"pageSpin___BAc4e",editor:"editor___YUj9q"},D=e(39378),T=e(87615),U=e(93059),i=e(9644),s=e(35459),y=e(92183),N=e(22283),m=e(1239),C=e(95073),V=e(23707),$=e(53357),t=e(35667),k=function(){var x,P=(0,R.useModel)("Project.auth"),u=P.checkPermission,a=(0,R.useModel)("Project.workspace"),r=a.pageData,n=a.pageState,B=a.loading,H=a.loadPageData,z=a.onInitPageState,oe=a.projectId,l=a.curRole,p=a.userRoles,ne=a.tabItems,Y=a.labelImages,F=a.isEditorVisible,re=a.onStatusTabChange,ie=a.onRoleChange,le=a.clickItem,se=a.loadMore,de=a.onExitEditor,ce=a.onNextImage,ue=a.onPrevImage,ve=a.onLabelSave,ge=a.onReviewAccept,me=a.onReviewReject,pe=a.onEnterEdit,X=a.onStartLabel,J=a.onStartRework,Q=a.onStartReview;(0,w._)({onInitPageState:z,pageState:n});var he=(0,$.bU)(),v=he.localeText,je=(0,w.w)(),fe=je.height,Z=(0,C.Z)(function(){return document.querySelector(".ant-pro-page-container")}),q=Z!=null&&Z.width?Z.width-80:0,xe=h.useRef(null),I=5,M=q?(q-16*(I-1))/(I||1):0,A=M*3/4,_=fe-46,Se=function(c){Math.floor(c.currentTarget.scrollHeight-c.currentTarget.scrollTop)===Math.floor(_)&&se()},K=(0,h.useMemo)(function(){return(0,D.chunk)(Y,I).map(function(W,c){return{index:c,lineImgs:W}})},[r.list]),Re=(0,h.useMemo)(function(){return r.editorMode!==i.je.View||n.taskStatus!==s.gZ.Working?[]:u(p,m.Oc.StartLabel)?n.status===s.j$.Labeling?[(0,t.jsx)(d.ZP,{type:"primary",onClick:X,children:v("proj.workspace.eTask.startLabel")},"label")]:n.status===s.j$.Reviewing?[(0,t.jsx)(d.ZP,{type:"primary",onClick:pe,children:v("proj.workspace.eTask.edit")},"edit")]:n.status===s.j$.Rejected?[(0,t.jsx)(d.ZP,{type:"primary",onClick:J,children:v("proj.workspace.eTask.startRework")},"rework")]:[]:u(p,m.Oc.StartReview)&&n.status===s.j$.Reviewing?[(0,t.jsx)(d.ZP,{type:"primary",onClick:Q,children:v("proj.workspace.eTask.startReview")},"review")]:[]},[n.status,n.taskStatus,r.editorMode,p]);return(0,t.jsxs)(b._z,{ghost:!0,className:o.page,fixedHeader:!0,pageHeaderRender:function(){return(0,t.jsxs)("div",{className:o.header,children:[(0,t.jsx)(d.ZP,{icon:(0,t.jsx)(y.Z,{}),type:"text",className:o.backBtn,onClick:function(){return(0,V.yS)("/project/".concat(oe))}}),(0,t.jsx)(E.Z,{className:o.tabs,activeKey:n.status,onChange:re,items:ne,tabBarExtraContent:(0,t.jsxs)("div",{children:[(0,t.jsx)(d.ZP,{type:"text",className:o.btn,icon:(0,t.jsx)(N.Z,{}),onClick:function(){return H()}}),l&&(l==null?void 0:l.labelNumWaiting)>0&&n.taskStatus===s.gZ.Working&&u(p,m.Oc.StartLabel)&&(0,t.jsx)(d.ZP,{type:"primary",className:o.btn,onClick:X,children:v("proj.workspace.eProj.startLabeling")}),l&&(l==null?void 0:l.reviewNumRejected)>0&&n.taskStatus===s.gZ.Working&&u(p,m.Oc.StartLabel)&&(0,t.jsx)(d.ZP,{type:"primary",className:o.btn,onClick:J,children:v("proj.workspace.eProj.startRework")}),l&&(l==null?void 0:l.reviewNumWaiting)>0&&n.taskStatus===s.gZ.Working&&u(p,m.Oc.StartReview)&&(0,t.jsx)(d.ZP,{type:"primary",className:o.btn,onClick:Q,children:v("proj.workspace.eProj.startReview")}),(0,t.jsxs)(T.Z,{data:r.taskRoles,value:n.roleId||"",filterOptionName:function(g){return"".concat(g.userName," (").concat(g.role,")")},filterOptionValue:function(g){return g.id},onChange:ie,ghost:!1,type:"default",children:[v("proj.workspace.eProj.role"),": ",l==null?void 0:l.userName,"(",l==null?void 0:l.role,")"]})]})})]})},children:[(0,t.jsx)(O.Z,{loading:B,className:o.list,children:K.length>0&&(0,t.jsx)(j.Z,{ref:xe,data:K,height:_,itemHeight:A+16,itemKey:"index",onScroll:Se,children:function(c,g){return(0,t.jsxs)(h.Fragment,{children:[(0,t.jsx)("div",{className:o.line,children:c.lineImgs.map(function(ee,te){return(0,t.jsx)("div",{className:o.item,style:{width:M},onClick:function(){return le(g*I+te)},children:(0,t.jsx)("div",{className:o.itemImgWrap,style:{width:M,height:A},children:(0,t.jsx)(i.D5,{isOldMode:!0,categories:r.categoryList,data:ee,wrapWidth:M,wrapHeight:A})})},"".concat(ee.id,"_").concat(te))})}),g===K.length-1&&r.loadingImagesType===U.D.More&&(0,t.jsx)(L.Z,{className:o.bottomSpin})]},g)}})}),F&&(0,t.jsx)("div",{className:o.editor,children:(0,t.jsx)(i.kl,{isOldMode:!0,isSeperate:!1,mode:r.editorMode,visible:F,categories:r.categoryList,list:Y,current:r.curIndex,pagination:{show:r.editorMode!==i.je.Review&&!(r.editorMode===i.je.Edit&&n.status===s.j$.Reviewing),total:r.total,customText:r.editorMode===i.je.Edit?(0,t.jsx)(t.Fragment,{}):void 0,customDisableNext:r.editorMode===i.je.Edit?!((x=r.list[r.curIndex])!==null&&x!==void 0&&x.labeled)||r.curIndex>=r.total-1:void 0},actionElements:Re,onCancel:de,onSave:ve,onReviewAccept:ge,onReviewReject:me,onNext:ce,onPrev:ue})})]})},f=k}}]);
