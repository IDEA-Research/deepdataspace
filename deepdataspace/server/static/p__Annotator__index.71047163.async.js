"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[734],{39800:function(re,w,t){t.d(w,{Z:function(){return B}});var $=t(60698),S=t(58757),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"},D=i,R=t(17202),V=function(e,G){return S.createElement(R.Z,(0,$.Z)({},e,{ref:G,icon:D}))},B=S.forwardRef(V)},54819:function(re,w,t){t.r(w),t.d(w,{default:function(){return Fe}});var $=t(88205),S=t.n($),i=t(58757),D=t(97375),R={container:"container___l9ot9",left:"left___z70k4",right:"right___JbF7R",modal:"modal___FjMyp"},V=t(14122),B=t(18695),P={"image-options-list":"image-options-list___oaSKK","virtual-list":"virtual-list___au11F","image-options":"image-options___Kuy9B","image-selected":"image-selected___qoFO4"},e=t(35667),G=function(r){var l=r.images,M=r.selected,m=r.onImageSelected,o=(0,i.useState)(0),U=S()(o,2),y=U[0],f=U[1],x=120,c=(0,i.useCallback)(function(){var h=document.getElementById("image-options-container");if(h){var u=h.offsetHeight||0;f(u-56)}},[]);(0,i.useEffect)(function(){return c(),window.addEventListener("resize",c),function(){window.removeEventListener("resize",c)}},[c]);var F=function(u){u<0||u>=l.length||m(u)};return(0,e.jsx)("div",{id:"image-options-container",className:P["image-options-list"],children:(0,e.jsx)(B.Z,{className:P["virtual-list"],data:l,height:y,fullHeight:!0,itemHeight:x,itemKey:"id",children:function(u,j){var d=j===M?P["image-selected"]:"";return(0,e.jsx)("div",{children:(0,e.jsx)("img",{className:"".concat(P["image-options"]," ").concat(d),src:u.url,onClick:function(){return F(j)}},u.id)})}})})},E=t(12562),se=t(39800),le=t(34485),K=t.n(le),ce=t(63900),Q=t.n(ce),de=t(60698),ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},me=ue,ge=t(17202),ve=function(r,l){return i.createElement(ge.Z,(0,de.Z)({},r,{ref:l,icon:me}))},fe=i.forwardRef(ve),X=t(23605),H=t(47513),he=t(65388),pe=t(62109),xe=t(15618),je=t(23241),Ce=t(21149),Y=t(37617),k=10,b=1e3,I={upload:"upload___kWr2Q",categories:"categories___BMpKT","categories-add":"categories-add___EDmRO","categories-add-textarea":"categories-add-textarea___IszF4","categories-add-button":"categories-add-button___MFR7y","categories-current":"categories-current___DghDV","categories-current-list":"categories-current-list___CkCO_","categories-current-list-item":"categories-current-list-item___oTUHZ","categories-current-text":"categories-current-text____g2ks"},q=t(65246),_=t(53357),L={container:"container___JWsIP","virtual-list":"virtual-list___RHt_f","row-container":"row-container___jF4kE","preview-container":"preview-container___MBTvK","remove-button":"remove-button___ehI2E","image-preview":"image-preview___LLGBt","image-name":"image-name___VQaOl"},ee=t(39378),Ie=(0,i.memo)(function(O){var r=O.files,l=O.colume,M=O.containerWidth,m=O.containerHeight,o=O.onRemoveFile,U=(0,i.useMemo)(function(){return(0,ee.chunk)(r,l).map(function(d,n){return{index:n,rowImages:d}})},[r,l]),y=8,f=.75,x=.95,c=30,F=(0,i.useMemo)(function(){return(M-(l-1)*y)/l},[M,l,y]),h=(0,i.useMemo)(function(){return F*x},[F,x]),u=(0,i.useMemo)(function(){return h*f},[h,f]),j=(0,i.useMemo)(function(){return u+c+10},[u,c]);return(0,e.jsx)("div",{id:"file-preview-container",className:L.container,style:{height:m},children:(0,e.jsx)(B.Z,{className:L["virtual-list"],data:U,height:m,fullHeight:!0,itemHeight:j,itemKey:"index",children:function(n,A){return(0,e.jsx)("div",{className:L["row-container"],style:{gap:y},children:n.rowImages.map(function(C,W){return(0,e.jsxs)("div",{className:"".concat(L["preview-container"]),style:{width:F,height:j},children:[(0,e.jsx)("div",{className:"".concat(L["remove-button"]),children:(0,e.jsx)(E.ZP,{className:L.btn,icon:(0,e.jsx)(X.Z,{}),shape:"circle",danger:!0,onClick:function(z){z.stopPropagation(),o(A*l+W)}})}),(0,e.jsx)("img",{className:"".concat(L["image-preview"]),src:C.thumbUrl||C.url,style:{width:h,height:u}}),(0,e.jsx)("div",{className:"".concat(L["image-name"]),children:C.name})]},C.uid)})},A)}})})}),Me=function(r){var l=r.open,M=r.setOpen,m=(0,_.bU)(),o=m.localeText,U=H.Z.useForm(),y=S()(U,1),f=y[0],x=(0,D.useModel)("Annotator.model"),c=x.images,F=x.categories,h=x.setImages,u=x.setCategories,j=(0,q.x)([]),d=S()(j,2),n=d[0],A=d[1],C=(0,q.x)(F),W=S()(C,2),T=W[0],z=W[1],Ne=he.Z.useNotification(),ae=S()(Ne,2),Se=ae[0],Oe=ae[1],ne=function(a){Se.info(Q()(Q()({},a),{},{placement:"topRight"}))},Ze=function(a){var g=a.file,p=a.fileList;if(g.uid===p[p.length-1].uid){var N=p.filter(function(Z){return!(Z.size&&Z.size/1024/1024>k)}).slice(0,b).map(function(Z){var J=URL.createObjectURL(Z.originFileObj);return Z.url=J,Z.thumbUrl=J,Z});A(N)}},oe=(0,i.useCallback)(function(s){return c[s]&&c[s].objects.length>0},[c]),Le=(0,i.useCallback)(function(s){if(oe(s)){ne({message:o("annotator.formModal.deleteImage.title"),description:o("annotator.formModal.deleteImage.desc"),duration:3});return}var a=(0,ee.cloneDeep)(n);a.splice(s,1),A(a)},[n,oe]),Ue=function(a){var g=a.map(function(v){return v.uid}),p=c.map(function(v){return v.id}),N=c.filter(function(v){return g.includes(v.id)&&p.includes(v.id)});h(N);var Z=a.filter(function(v){return!p.includes(v.uid)}),J=Z.map(function(v){var ie=v.url||URL.createObjectURL(v.originFileObj),be={id:v.uid,url:ie,urlFullRes:ie,fileName:v.name,objects:[]};return be});h(function(v){return[].concat(K()(v),K()(J))})};(0,i.useEffect)(function(){z(F)},[l]);var Ae=function(){return T.length===0?Promise.reject(o("annotator.formModal.categoryRequiredMsg")):Promise.resolve()},Te=function(a){var g=a.split(`
`).map(function(p){return p.trim()}).filter(Boolean);return g},Re=function(a){var g=K()(T).map(function(N){return N.name}),p=[];a.forEach(function(N){g.includes(N)||(g.push(N),p.push({id:N,name:N}))}),z([].concat(K()(T),p))},Ee=function(){var a=f.getFieldValue("categoryStr"),g=Te(a);Re(g),f.setFieldValue("categoryStr",""),f.validateFields()},He=function(a){z(T.filter(function(g){return g.name!==a}))},Pe=function(a){return!!c.find(function(g){return g.objects.find(function(p){return p.categoryName===a})})};return(0,e.jsxs)(pe.Z,{open:l,centered:!0,width:700,title:o("annotator.formModal.title"),onCancel:function(){f.validateFields().then(function(){M(!1)})},onOk:function(){f.validateFields().then(function(){Ue(n),u(T),M(!1)}).catch(function(a){console.log("Validate Failed:",a)})},children:[Oe,(0,e.jsx)(xe.Z,{message:o("annotator.notice"),type:"info",showIcon:!0,style:{margin:"20px 0"}}),(0,e.jsxs)(H.Z,{layout:"vertical",form:f,requiredMark:!1,children:[(0,e.jsx)(H.Z.Item,{label:(0,e.jsx)("h4",{children:o("annotator.formModal.importImages")}),name:"fileList",required:!0,extra:(0,e.jsxs)(e.Fragment,{children:[n.length>0&&(0,e.jsx)(Ie,{files:n,colume:4,containerWidth:652,containerHeight:270,onRemoveFile:Le}),(0,e.jsx)("p",{children:o("annotator.formModal.imageTips",{count:b,size:k})})]}),children:(0,e.jsx)(je.Z,{className:I.upload,multiple:!0,showUploadList:!1,beforeUpload:function(){return!1},accept:"image/png, image/jpeg, image/jpg",fileList:n,maxCount:b,openFileDialogOnClick:n.length<b,onChange:Ze,children:(0,e.jsx)(E.ZP,{className:I.uploadBtn,type:"primary",icon:(0,e.jsx)(fe,{}),style:{marginBlockEnd:"10px"},disabled:n.length>=b,children:o("dataset.import.modal.upload")})})}),(0,e.jsx)(H.Z.Item,{label:(0,e.jsx)("h4",{children:o("annotator.formModal.categories")}),children:(0,e.jsxs)("div",{className:I.categories,children:[(0,e.jsxs)("div",{className:I["categories-add"],children:[(0,e.jsx)(H.Z.Item,{name:"categoryStr",initialValue:"",children:(0,e.jsx)(Ce.Z.TextArea,{className:I["categories-add-textarea"],rows:6,placeholder:o("annotator.formModal.categoryPlaceholder"),onKeyDown:function(a){return a.stopPropagation()},allowClear:!0,value:f.getFieldValue("categoryStr")})}),(0,e.jsx)(E.ZP,{className:I["categories-add-btn"],onClick:Ee,children:o("annotator.formModal.addCategory")})]}),(0,e.jsxs)("div",{className:I["categories-current"],children:[(0,e.jsx)(H.Z.Item,{name:"tempCategories",rules:[{validator:Ae}],children:(0,e.jsx)(Y.Z,{className:I["categories-current-list"],bordered:!0,size:"small",dataSource:T,renderItem:function(a){return(0,e.jsx)(Y.Z.Item,{className:I["categories-current-list-item"],style:{padding:"2px 16px"},actions:[(0,e.jsx)(E.ZP,{danger:!0,type:"text",icon:(0,e.jsx)(X.Z,{}),onClick:function(){Pe(a.name)?ne({message:o("annotator.formModal.deleteCategory.title"),description:o("annotator.formModal.deleteCategory.desc"),duration:3}):He(a.name)}},"delete")],children:a.name},a.id)}})}),(0,e.jsx)("p",{className:I["categories-current-text"],children:"".concat(o("annotator.formModal.categoriesCount"),": ").concat(T.length)})]})]})})]})]})},te=t(2556),ye=function(){var r=(0,D.useModel)("Annotator.model"),l=r.images,M=r.setImages,m=r.current,o=r.setCurrent,U=r.categories,y=r.setCategories,f=r.exportAnnotations,x=(0,_.bU)(),c=x.localeText,F=(0,i.useState)(!0),h=S()(F,2),u=h[0],j=h[1];return(0,i.useEffect)(function(){},[]),(0,i.useEffect)(function(){var d=localStorage.getItem("images"),n=localStorage.getItem("categories");d&&n&&(M(JSON.parse(d)),y(JSON.parse(n)),j(!1))},[]),(0,te.Z)("uparrow",function(){o(Math.max(0,m-1))},{exactMatch:!0}),(0,te.Z)("downarrow",function(){o(Math.min(m+1,l.length-1))},{exactMatch:!0}),(0,e.jsxs)("div",{className:R.container,children:[(0,e.jsxs)("div",{className:R.left,onMouseDown:function(n){n.stopPropagation()},onMouseUp:function(n){n.stopPropagation()},children:[(0,e.jsx)(E.ZP,{type:"primary",icon:(0,e.jsx)(se.Z,{}),onClick:function(){j(!0)},children:c("annotator.setting")}),(0,e.jsx)(G,{images:l,selected:m,onImageSelected:function(n){o(n)}})]}),(0,e.jsx)("div",{className:R.right,children:(0,e.jsx)(V.kl,{isSeperate:!0,visible:!0,mode:V.je.Edit,categories:U,setCategories:y,list:l,current:m,actionElements:[(0,e.jsx)(E.ZP,{type:"primary",onClick:f,children:c("annotator.export")},"export")],onAutoSave:function(n,A){M(function(C){C[m]&&(C[m].objects=n,C[m].width=A.width,C[m].height=A.height)})}})}),(0,e.jsx)("div",{className:R.modal,onMouseDown:function(n){return n.stopPropagation()},onMouseUp:function(n){return n.stopPropagation()},children:(0,e.jsx)(Me,{open:u,setOpen:j})})]})},Fe=ye}}]);

//# sourceMappingURL=p__Annotator__index.71047163.async.js.map