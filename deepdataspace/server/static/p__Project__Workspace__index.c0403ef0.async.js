"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[914],{46262:function(q,M,e){e.d(M,{Z:function(){return w}});var v=e(52983),P=e(44580),D=e(56084),Z=e(57006),l=e(81553),I=e(58174),O=e(68505),f=e(7818),j={dropdownSelector:"dropdownSelector___gvMFq",dropdownWrap:"dropdownWrap___WWYlz",dropdownBox:"dropdownBox___lpUVf"},d=e(97458),E=function(i){var c=i.data,N=i.multiple,R=i.type,b=R===void 0?"primary":R,T=i.ghost,C=T===void 0?!0:T,u=i.value,k=i.filterOptionValue,U=i.filterOptionName,h=i.onChange,$=i.className,_=i.children,z=i.customOverlay,t=N?P.Z:D.ZP,J=function(m){h&&h(N?m:m.target.value)};return(0,d.jsx)(Z.Z,{overlayClassName:j.dropdownSelector,trigger:["click"],dropdownRender:function(){return(0,d.jsx)("div",{className:j.dropdownWrap,children:z||(0,d.jsx)(t.Group,{className:j.dropdownBox,onChange:J,value:u,children:(0,d.jsx)(l.Z,{direction:"vertical",children:c==null?void 0:c.map(function(m,S){var L=k?k(m):m,p=U?U(m):m;return(0,d.jsx)(t,{value:L,children:(0,f._w)(p)},S)})})})})},children:(0,d.jsxs)(I.ZP,{className:$,type:b,ghost:C,children:[_,(0,d.jsx)(O.Z,{})]})})},w=E},94820:function(q,M,e){e.d(M,{Z:function(){return O}});var v=e(63900),P=e.n(v),D=e(88205),Z=e.n(D),l=e(52983),I=e(5451);function O(f){var j=f.pageState,d=f.onInitPageState,E=f.onPageDidMount,w=f.onPageWillUnmount,r=(0,I.Z)({},{navigateMode:"replace"}),i=Z()(r,2),c=i[0],N=i[1];(0,l.useEffect)(function(){if(d){var R={};try{R=c.pageState?JSON.parse(c.pageState):{}}catch(b){console.error("get urlPageState error: ",b)}d(R,c)}return E&&E(c),function(){w&&w()}},[]),(0,l.useEffect)(function(){N(P()(P()({},c),{},{pageState:JSON.stringify(j)}))},[j])}},43182:function(q,M,e){e.r(M),e.d(M,{default:function(){return G}});var v=e(52983),P=e(52994),D=e(94820),Z=e(40852),l=e(58174),I=e(5670),O=e(17212),f=e(19419),j=e(35115),d=e(88205),E=e.n(d);function w(){var m=(0,v.useState)(window.innerWidth),S=E()(m,2),L=S[0],p=S[1],a=(0,v.useState)(window.innerHeight),n=E()(a,2),s=n[0],Y=n[1],B=function(){p(window.innerWidth),Y(window.innerHeight)};return(0,v.useEffect)(function(){return window.addEventListener("resize",B),function(){window.removeEventListener("resize",B)}},[]),{width:L,height:s}}var r={page:"page___DZyiW",header:"header___bRKb4",backBtn:"backBtn___yET2T",tabs:"tabs___weXzX",btn:"btn____fESN",line:"line___k1GQQ",item:"item___Jv55m",itemImgWrap:"itemImgWrap___bWdL3",flagIcon:"flagIcon___PULYz",label:"label___LGG_W",itemSelectedMask:"itemSelectedMask___mU2PX",topSpin:"topSpin___eLVKZ",bottomSpin:"bottomSpin___MuKRE",pagination:"pagination___WlY5J",pageSpin:"pageSpin___BAc4e",editor:"editor___YUj9q"},i=e(40902),c=e(39378),N=e(46262),R=e(90046),b=e(50030),T=e(51297),C=e(74004),u=e(23319),k=e(89398),U=e(51885),h=e(22689),$=e(19950),_=e(42652),z=e(7818),t=e(97458),J=function(){var S,L=(0,P.useModel)("Project.auth"),p=L.checkPermission,a=(0,P.useModel)("Project.workspace"),n=a.pageData,s=a.pageState,Y=a.loading,B=a.loadPageData,ee=a.onInitPageState,ce=a.projectId,o=a.curRole,W=a.userRoles,ue=a.tabItems,te=a.labelImages,ve=a.categoryColors,ae=a.isEditorVisible,me=a.onStatusTabChange,ge=a.onRoleChange,he=a.clickItem,pe=a.loadMore,fe=a.onExitEditor,je=a.onNextImage,Se=a.onPrevImage,ye=a.onLabelSave,xe=a.onReviewResult,ne=a.onEnterEdit,oe=a.onStartLabel,re=a.onStartRework,ie=a.onStartReview;(0,D.Z)({onInitPageState:ee,pageState:s});var Pe=(0,z.bU)(),y=Pe.localeText,Ee=w(),Re=Ee.height,A=(0,$.Z)(function(){return document.querySelector(".ant-pro-page-container")}),se=A!=null&&A.width?A.width-80:0,Ce=v.useRef(null),H=5,K=se?(se-16*(H-1))/(H||1):0,F=K*3/4,le=Re-46,Me=function(g){Math.floor(g.currentTarget.scrollHeight-g.currentTarget.scrollTop)===Math.floor(le)&&pe()},Q=(0,v.useMemo)(function(){return(0,c.chunk)(te,H).map(function(V,g){return{index:g,lineImgs:V}})},[n.list]),we=(0,v.useMemo)(function(){return n.editorMode!==C.je.View||s.taskStatus!==u.gZ.Working?[]:p(W,h.Oc.StartLabel)?s.status===u.j$.Labeling?[(0,t.jsx)(l.ZP,{type:"primary",onClick:oe,children:y("proj.workspace.eTask.startLabel")},"label")]:s.status===u.j$.Reviewing?[(0,t.jsx)(l.ZP,{type:"primary",onClick:ne,children:y("proj.workspace.eTask.edit")},"edit")]:s.status===u.j$.Rejected?[(0,t.jsx)(l.ZP,{type:"primary",onClick:re,children:y("proj.workspace.eTask.startRework")},"rework")]:[]:p(W,h.Oc.StartReview)&&s.status===u.j$.Reviewing?[(0,t.jsx)(l.ZP,{type:"primary",onClick:ie,children:y("proj.workspace.eTask.startReview")},"review")]:[]},[s.status,s.taskStatus,n.editorMode,W]);return(0,t.jsxs)(Z._z,{ghost:!0,className:r.page,fixedHeader:!0,pageHeaderRender:function(){return(0,t.jsxs)("div",{className:r.header,children:[(0,t.jsx)(l.ZP,{icon:(0,t.jsx)(k.Z,{}),type:"text",className:r.backBtn,onClick:function(){return(0,_.yS)("/project/".concat(ce))}}),(0,t.jsx)(I.Z,{className:r.tabs,activeKey:s.status,onChange:me,items:ue,tabBarExtraContent:(0,t.jsxs)("div",{children:[(0,t.jsx)(l.ZP,{type:"text",className:r.btn,icon:(0,t.jsx)(U.Z,{}),onClick:function(){return B()}}),o&&(o==null?void 0:o.labelNumWaiting)>0&&s.taskStatus===u.gZ.Working&&p(W,h.Oc.StartLabel)&&(0,t.jsx)(l.ZP,{type:"primary",className:r.btn,onClick:oe,children:y("proj.workspace.eProj.startLabeling")}),o&&(o==null?void 0:o.reviewNumRejected)>0&&s.taskStatus===u.gZ.Working&&p(W,h.Oc.StartLabel)&&(0,t.jsx)(l.ZP,{type:"primary",className:r.btn,onClick:re,children:y("proj.workspace.eProj.startRework")}),o&&(o==null?void 0:o.reviewNumWaiting)>0&&s.taskStatus===u.gZ.Working&&p(W,h.Oc.StartReview)&&(0,t.jsx)(l.ZP,{type:"primary",className:r.btn,onClick:ie,children:y("proj.workspace.eProj.startReview")}),(0,t.jsxs)(N.Z,{data:n.taskRoles,value:s.roleId||"",filterOptionName:function(x){return"".concat(x.userName," (").concat(x.role,")")},filterOptionValue:function(x){return x.id},onChange:ge,ghost:!1,type:"default",children:[y("proj.workspace.eProj.role"),": ",o==null?void 0:o.userName,"(",o==null?void 0:o.role,")"]})]})})]})},children:[(0,t.jsx)(O.ZP,{loading:Y,className:r.list,children:Q.length>0&&(0,t.jsx)(j.Z,{ref:Ce,data:Q,height:le,itemHeight:F+16,itemKey:"index",onScroll:Me,children:function(g,x){return(0,t.jsxs)(v.Fragment,{children:[(0,t.jsx)("div",{className:r.line,children:g.lineImgs.map(function(X,de){return(0,t.jsx)("div",{className:r.item,style:{width:K},onClick:function(){return he(x*H+de)},children:(0,t.jsx)("div",{className:r.itemImgWrap,style:{width:K,height:F},children:(0,t.jsx)(i.Z,{wrapWidth:K,wrapHeight:F,image:X,objects:X.objects,displayType:R.JJ.Detection,globalDisplayOptions:{categoryColors:ve}})})},"".concat(X.id,"_").concat(de))})}),x===Q.length-1&&n.loadingImagesType===b.D.More&&(0,t.jsx)(f.Z,{className:r.bottomSpin})]},x)}})}),ae&&(0,t.jsx)("div",{className:r.editor,children:(0,t.jsx)(T.Z,{isSeperate:!1,mode:n.editorMode,visible:ae,categories:n.categoryList,list:te,current:n.curIndex,pagination:{show:n.editorMode!==C.je.Review&&!(n.editorMode===C.je.Edit&&s.status===u.j$.Reviewing),total:n.total,customText:n.editorMode===C.je.Edit?(0,t.jsx)(t.Fragment,{}):void 0,customDisableNext:n.editorMode===C.je.Edit?!((S=n.list[n.curIndex])!==null&&S!==void 0&&S.labeled)||n.curIndex>=n.total-1:void 0},actionElements:we,onCancel:fe,onSave:ye,onReviewResult:xe,onEnterEdit:ne,onNext:je,onPrev:Se})})]})},G=J}}]);
